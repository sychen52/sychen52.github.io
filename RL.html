<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Reinforcement Learning</title>
<meta name="generator" content="Org mode" />
<link rel="stylesheet" type="text/css" href="https://orgmode.org/worg/style/worg.css"/>
</head>
<body>
<div id="content">
<h1 class="title">Reinforcement Learning</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orga15e330">Trajectory = Episode = Rollout</a></li>
<li><a href="#orga5a0ac3">Value Functions</a>
<ul>
<li><a href="#orga79a668">On-Policy vs. Optimal</a></li>
<li><a href="#orgc4752de">Value Function vs. Action-Value Function</a>
<ul>
<li><a href="#orgcb96d98">If On-Policy</a></li>
<li><a href="#org4f3bb58">IF Optimal</a></li>
<li><a href="#org897324e">Q-Function is Action-Value Function</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9e10452">Optimal action is the argmax<sub>a</sub> Optimal Q-Function</a></li>
<li><a href="#org86d6be4">Bellman Equation</a></li>
<li><a href="#org8216d1a">Advantage Functions</a></li>
<li><a href="#orgb87b056">Policy Optimization vs. Q-Learning</a></li>
<li><a href="#orgf1188b3">Policy Optimization and Policy Gradient</a></li>
</ul>
</div>
</div>

<div id="outline-container-orga15e330" class="outline-2">
<h2 id="orga15e330">Trajectory = Episode = Rollout</h2>
<div class="outline-text-2" id="text-orga15e330">
<p>
a sequence of state and action
&tau; ~ &pi; means &tau; is a random trajectory sampled based on policy &pi;. Two things can be random here: state transition, action taken based on a policy.
</p>
</div>
</div>

<div id="outline-container-orga5a0ac3" class="outline-2">
<h2 id="orga5a0ac3">Value Functions</h2>
<div class="outline-text-2" id="text-orga5a0ac3">
<p>
Four different types of value function, if you combine the following two.
</p>
</div>
<div id="outline-container-orga79a668" class="outline-3">
<h3 id="orga79a668">On-Policy vs. Optimal</h3>
<div class="outline-text-3" id="text-orga79a668">
<p>
A specific policy &pi; vs. the optimal policy *
</p>
</div>
</div>
<div id="outline-container-orgc4752de" class="outline-3">
<h3 id="orgc4752de">Value Function vs. Action-Value Function</h3>
<div class="outline-text-3" id="text-orgc4752de">
</div>
<div id="outline-container-orgcb96d98" class="outline-4">
<h4 id="orgcb96d98">If On-Policy</h4>
<div class="outline-text-4" id="text-orgcb96d98">
<p>
Expectation over all possible actions from the policy vs. given a specific action a (the action may not from the polity).
</p>
</div>
</div>
<div id="outline-container-org4f3bb58" class="outline-4">
<h4 id="org4f3bb58">IF Optimal</h4>
<div class="outline-text-4" id="text-org4f3bb58">
<p>
Max over &#x2026;
</p>

<p>
Since it is the optimal policy, all possible actions only contain the best/max-return action.
</p>
</div>
</div>
<div id="outline-container-org897324e" class="outline-4">
<h4 id="org897324e">Q-Function is Action-Value Function</h4>
</div>
</div>
</div>

<div id="outline-container-org9e10452" class="outline-2">
<h2 id="org9e10452">Optimal action is the argmax<sub>a</sub> Optimal Q-Function</h2>
<div class="outline-text-2" id="text-org9e10452">
<p>
since it is optimal
</p>
</div>
</div>

<div id="outline-container-org86d6be4" class="outline-2">
<h2 id="org86d6be4">Bellman Equation</h2>
<div class="outline-text-2" id="text-org86d6be4">
<p>
Expand any of the 4 value functions one step and make it recursive.
</p>

<p>
If it is optimal value function or Q-function, the expansion will have a max<sub>a</sub> instead of E<sub>a~&pi;</sub>.
</p>
</div>
</div>

<div id="outline-container-org8216d1a" class="outline-2">
<h2 id="org8216d1a">Advantage Functions</h2>
<div class="outline-text-2" id="text-org8216d1a">
<p>
Q(s,a)-V(s)
</p>
</div>
</div>

<div id="outline-container-orgb87b056" class="outline-2">
<h2 id="orgb87b056">Policy Optimization vs. Q-Learning</h2>
<div class="outline-text-2" id="text-orgb87b056">
<ul class="org-ul">
<li>both are for Model Free RL</li>
<li>Policy optimization predicts the distribution of the action given the observation.</li>
<li>Policy Optimization's objective/loss function estimates a [surrogate] value function
surrogate means the gradient is the same/similar, but the objective function is not just value function.</li>
<li>Q-Learning estimates Q-function based on Bellman equation</li>
<li>more vs. less stable: Satisfying Bellman equation is an indirect meassure of maximizing reward. And it has failure mode.</li>
<li>less vs. more data effective. (on vs. off policy). Policy Optimization has to be on the latest policy</li>
</ul>
</div>
</div>

<div id="outline-container-orgf1188b3" class="outline-2">
<h2 id="orgf1188b3">Policy Optimization and Policy Gradient</h2>
<div class="outline-text-2" id="text-orgf1188b3">
<p>
This time, the NN directly learn the policy itself (given state/observation as input, what should be the action (or probability of take that action)).
</p>

<p>
Instead of computing a loss as "expected total reward of a policy" (J = E[R(&tau;)]), and then take a gradient of that and do gradient ascent (This is impossible when we cannot take derivative of the environment), we derive the equation of the gradient of J, then ignore all the terms that has 0-grad. This new equation is called grad-log-prob.
</p>

<p>
Now the NN takes an observation and predicts the logits of &pi;(a|s). This is the parameters of the action distribution in current state. Then you sample this distribution to get an action. The so-called loss is the grad-log-prob term before taking the gradient.
</p>

<p>
You can think of this "grad-log-prob term before taking the gradient" as an approximation of J, because they have the same gradient.
</p>

<p>
In summary, NN predicts the action distribution. The loss was designed such as its gradient is the same as dJ/d&theta;.
</p>

<script src="https://utteranc.es/client.js"
        repo="sychen52/sychen52.github.io"
        issue-term="pathname"
        theme="github"
        crossorigin="anonymous"
        async>
</script>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="validation"></p>
</div>
</body>
</html>
